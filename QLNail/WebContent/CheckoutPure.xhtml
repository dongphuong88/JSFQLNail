<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<meta charset="utf-8" http-equiv="x-ua-compatible" content="ie=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<h:outputStylesheet library="css" name="common.css" />
	<h:outputStylesheet library="css" name="w3.css"></h:outputStylesheet>
	
	<style>
		.ui-datatable .ui-datatable-header, .ui-datatable .ui-datatable-footer {
			text-align:left;
		}
	</style>
	
	<title>Insert title here</title>
</h:head>
<h:body>
	<h3>
		<label class="w3-label">Date/Time: </label>
		<h:outputText value="#{checkoutBeanPure.currDateTime}">
			<f:convertDateTime pattern="MM/dd/yyyy - hh:mm a"/>
		</h:outputText>
	</h3>
	
	<h:form id="serviceForm" style="height:100%">
		<p:dataTable id="services" var="service" value="#{checkoutBeanPure.services}">
			<p:column style="width:100px;text-align: center;padding:0px;">
	             <p:commandButton update=":serviceForm:editServiceDialogID" oncomplete="PF('editServiceDialogVar').show()" icon="ui-icon-pencil" title="Edit">
	                <f:setPropertyActionListener value="#{service}" target="#{checkoutBeanPure.editTransactionService}" />
	            </p:commandButton>
	            <p:commandButton update=":serviceForm:services,transactionForm" actionListener="#{checkoutBeanPure.deleteServiceRow(service)}" icon="ui-icon-closethick" title="Delete">
	            </p:commandButton>
	        </p:column>
			<p:column headerText="Service">
				<h:outputText value="#{service.serviceName}" />
			</p:column>
			<p:column headerText="Employee">
				<h:outputText value="#{service.employeeName}" />
			</p:column>
			<p:column headerText="Amount">
				<h:outputText value="#{service.amount}" >
					<f:convertNumber currencySymbol="$" type="currency"/>
				</h:outputText>
			</p:column>
			<p:columnGroup type="footer">
				<p:row>
					<p:column colspan="3" style="text-align:right" footerText="Totals:" />
					<p:column id="serviceTotal" styleClass="serviceTotal" style="text-align:left"
						footerText="#{checkoutBeanPure.totalServiceAmount}" ></p:column>
				</p:row>
			</p:columnGroup>
			<f:facet name="footer">
				<p:commandButton onclick="PF('newServiceDialogVar').show();$('#serviceForm\\:addServicePanel input').val('');" value="Add Service" id="btnAddService" icon="ui-icon-circle-plus" />
				
			</f:facet>
		</p:dataTable>

		<p:dialog id="newServiceDialogID" position="center" widgetVar="newServiceDialogVar" header="Add New Service"
			modal="true" showEffect="fade" hideEffect="fade" resizable="false" >
			<h:panelGrid columns="2" cellpadding="0" id="addServicePanel">
				<p:outputLabel value="Service:" for="txtNewService" />
				<p:inputText id="txtNewService" placeholder="Enter Service" value="#{checkoutBeanPure.newTransactionService.serviceName}"></p:inputText>
				
				<p:outputLabel value="Employye:" for="txtNewEmployee" />
				<p:inputText id="txtNewEmployee" placeholder="Enter Employee" value="#{checkoutBeanPure.newTransactionService.employeeName}"></p:inputText>
				
				<p:outputLabel value="Amount:" for="txtNewAmount" />
				<p:inputText id="txtNewAmount" placeholder="Enter Amount" type="number"  value="#{checkoutBeanPure.newTransactionService.amount}"></p:inputText>
				
				<p:commandButton update=":serviceForm:services,transactionForm"  onclick="PF('newServiceDialogVar').hide();" actionListener="${checkoutBeanPure.addServiceRow()}" value="Add" icon="ui-icon-circle-plus" />
				<p:commandButton onclick="PF('newServiceDialogVar').hide();" value="Cancel" icon="ui-icon-circle-plus" />
			</h:panelGrid>
		</p:dialog>
		
		<p:dialog id="editServiceDialogID" position="center" widgetVar="editServiceDialogVar" header="Edit Service"
			modal="true" showEffect="fade" hideEffect="fade" resizable="false">
			<h:panelGrid columns="2" cellpadding="0" id="editServicePanel">
				<p:outputLabel value="Service:" for="txtEditService" />
				<p:inputText id="txtEditService" placeholder="Enter Service" value="#{checkoutBeanPure.editTransactionService.serviceName}" onfocus="$(this).select();"></p:inputText>
				
				<p:outputLabel value="Employee:" for="txtEditEmployee" />
				<p:inputText id="txtEditEmployee" placeholder="Enter Employee" value="#{checkoutBeanPure.editTransactionService.employeeName}" onfocus="$(this).select();"></p:inputText>
				
				<p:outputLabel value="Amount:" for="txtEditAmount" />
				<p:inputText id="txtEditAmount" placeholder="Enter Amount" type="number"  value="#{checkoutBeanPure.editTransactionService.amount}" onfocus="$(this).select();"></p:inputText>
				
				<p:commandButton update=":serviceForm:services,transactionForm" actionListener="#{checkoutBeanPure.updateServicesAmount()}" onclick="PF('editServiceDialogVar').hide();" value="Save" icon="ui-icon-circle-plus" />
				<p:commandButton onclick="PF('editServiceDialogVar').hide();" value="Cancel" icon="ui-icon-circle-plus" />
			</h:panelGrid>
		</p:dialog>
	</h:form>
	
	<h:form id="transactionForm">
		<div class="w3-container" style="width:800px; float:left">
			<h3>Pay by:</h3>
			<div class="w3-third">
				<h:outputLabel value="Gift Card#:" for="giftNo"></h:outputLabel>
				<p:inputText id="giftNo" style="width:160px;" value="#{checkoutBeanPure.giftCardNo}" onfocus="$(this).select()"></p:inputText>
				<h:outputLabel value="Gift Card Amount:" for="gift"></h:outputLabel>
				<p:inputText id="gift" style="width:110px;" type="number" value="#{checkoutBeanPure.giftCard}" onfocus="$(this).select()"></p:inputText>
			</div>
			<div class="w3-third">
				<h:outputLabel value="Credit: " for="credit"></h:outputLabel>
				<p:inputText id="credit" type="number" value="#{checkoutBeanPure.credit}" onfocus="$(this).select()"></p:inputText>
				<h:outputLabel value="Cash:&nbsp;&nbsp;&nbsp;" for="cash"></h:outputLabel>
				<p:inputText id="cash" type="number" value="#{checkoutBeanPure.cash}" onfocus="$(this).select()"></p:inputText>
			</div>
			<div class="w3-third">
				<h:outputLabel value="Tip: " for="tip"></h:outputLabel>
				<p:inputText id="tip" type="number" value="#{checkoutBeanPure.tip}" onfocus="$(this).select()"></p:inputText>
				
				<p:selectOneRadio id="tipAmount" value="#{checkoutBeanPure.tipSelected}" onchange="tipChange()" layout="grid" columns="1" style="margin-left:30px">
					<f:selectItems value="#{checkoutBeanPure.tipTypes}" var="c" itemLabel="#{tipType}" itemValue="#{tipType}"/>
		        </p:selectOneRadio>
			</div>
		</div>
		<div class="w3-left">
			<h1>
				<label>Total: </label>
				<p:outputLabel value="#{checkoutBeanPure.total}">
					<f:convertNumber pattern="$#0.00" />
				</p:outputLabel>
			</h1>
			<p:commandButton style="width:180px;height:50px;display:block;" value="Print"></p:commandButton>
			<p:commandButton style="width:180px;height:50px;margin-top:10px" value="Email"></p:commandButton>
		</div>
		<p:remoteCommand name="myRemote" actionListener="#{checkoutBeanPure.tipChange()}" />
	</h:form>

	<h:outputScript library="js" name="common.js"></h:outputScript>
	<script>
		function tipChange() {
			myRemote();
		}
	</script>
</h:body>
</html>