<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<meta http-equiv="x-ua-compatible" content="ie=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<h:outputStylesheet library="css" name="w3.css" />
	<h:outputStylesheet library="css" name="common.css" />
	<h:outputStylesheet library="css" name="font-awesome.min.css" />
	<h:outputScript library="js" name="jquery-2.2.4.min.js"> </h:outputScript>
	
	<style>
		.ui-datatable .ui-datatable-header, .ui-datatable .ui-datatable-footer {
			text-align:left;
		}
	</style>
	<title>Insert title here</title>
</h:head>
<h:body>
<div class="w3-container">
	<h3><label class="w3-label">Date/Time: </label>
	<h:outputText value="#{checkoutBean.currDateTime}" /></h3>
</div>

<h:form id="form">
<div class="w3-container">
	
		<p:growl id="msgs" showDetail="true" />
		<p:dataTable id="services" var="service" value="#{checkoutBean.services}"
			editable="true" editMode="cell" widgetVar="cellService">

			<p:column style="width:64px;text-align: center">
	             <p:commandButton update=":form:services" icon="ui-icon-closethick" title="View" action="#{checkoutBean.deleteTransactionRow(service)}">
	            </p:commandButton>
	        </p:column>
			
			<p:column headerText="Service">
				<p:cellEditor>
					<f:facet name="output">
						<h:outputText value="#{service.serviceName}" placeholder="Enter Service"/>
					</f:facet>
					<f:facet name="input">
						<p:inputText id="modelInput" value="#{service.serviceName}" style="width:96%; padding: 8px;display: block;border: none;border-bottom: 1px solid #808080;width: 100%;" label="Service" placeholder="test"/>
					</f:facet>
				</p:cellEditor>
			</p:column>

			<p:column headerText="Employee">
				<p:cellEditor>
					<f:facet name="output">
						<h:outputText value="#{service.employeeName}" />
					</f:facet>
					<f:facet name="input">
						<p:inputText value="#{service.employeeName}" style="width:96%" label="Employee"/>
					</f:facet>
				</p:cellEditor>
			</p:column>

			<p:column headerText="Amount">
				<p:inputText value="#{service.amount}" type="number" styleClass="serviceAmount" style="width:96%" label="Amount" onchange="updateServiceTotal()"  onfocus="$(this).select()"/>
			</p:column>
			<p:columnGroup type="footer">
	            <p:row>
	                <p:column colspan="3" style="text-align:right" footerText="Totals:" />
	                <p:column styleClass="serviceTotal" style="text-align:left" footerText="#{checkoutBean.totalServiceAmount}" />
	            </p:row>
	        </p:columnGroup>
	        <f:facet name="footer">
	            <p:commandButton update=":form:services" actionListener="#{checkoutBean.addNewServiceRow()}" value="Add Service" id="btnAddService" icon="ui-icon-circle-plus" />
	        </f:facet>
		</p:dataTable>
	
	</div>
	<div class="w3-container w3-threequarter">
		<h3>Pay by:</h3>
		<div class="w3-third">
			<label class="w3-label">Gift Card #:</label>
			<input class="w3-input" type="text" value="${checkoutBean.giftCardNo}"></input>
			<label class="w3-label">Gift Card Amount:</label>
			<input class="w3-input" type="number" value="${checkoutBean.giftCardAmount}"></input>
		</div>
		<div class="w3-third w3-container">
			<label class="w3-label">Credit Card:</label>
			<input class="w3-input" type="number" value="${checkoutBean.creditCardAmount}"></input>
			<label class="w3-label">Cash:</label>
			<input class="w3-input" type="number" value="${checkoutBean.cashAmount}"></input>
		</div>
		<div class="w3-third w3-container">
			<label class="w3-label">Tip:</label>
			<input class="w3-input" type="number" value="${checkoutBean.tipAmount}"></input>
			<label class="w3-validate" style="display:block"><input class="w3-radio" type="radio" name="tipPercent" value="tipPercent15"/>
			15% - $10.00</label>
			<label class="w3-validate" style="display:block"><input class="w3-radio" type="radio" name="tipPercent" value="tipPercent15"/>
			18% - $10.00</label>
			<label class="w3-validate" style="display:block"><input class="w3-radio" type="radio" name="tipPercent" value="tipPercent15"/>
			20% - $10.00</label>
		</div>
	</div>
	<div class="w3-container">
		<h1>Total: <h:outputText value="#{checkoutBean.totalTransaction}" >
			<f:convertNumber type="currency" currencySymbol="$" />
		</h:outputText></h1>
	</div>
	<div class="w3-container w3-center" style="margin-top:10px;">
		<p:commandLink actionListener="#{checkoutBean.clickedPrint()}" styleClass="w3-btn" style=" width:200px;" value="Print"></p:commandLink>
		<a class="w3-btn" style=" width:200px;" onclick="updateServiceTotal()">Email</a>
	</div>
	</h:form>
	<h:outputScript library="js" name="common.js"></h:outputScript>
	<script>
		function updateServiceTotal() {
			var total = 0;
			$("#form .serviceAmount").each( function() {
				//var amount = $(this).text().substring(1, $(this).text().length).replace(",","");
				
				total += +$(this).val();//parseFloat(amount);
			} );
			$("#form .serviceTotal").html("$" + total.toFixed(2).replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,"));
			
			
		}
	</script>
</h:body>
</html>