<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<meta charset="utf-8" http-equiv="x-ua-compatible" content="ie=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<h:outputStylesheet library="css" name="common.css" />
	<h:outputStylesheet library="css" name="w3.css"></h:outputStylesheet>
	
	<style>
		.ui-datatable .ui-datatable-header, .ui-datatable .ui-datatable-footer {
			text-align:left;
		}
	</style>
	
	<title>Insert title here</title>
</h:head>
<h:body>
	<div class="w3-container w3-xlarge">
		<label class="w3-label">Date/Time: </label>
		<h:outputText value="#{checkoutBean.currDateTime}">
			<f:convertDateTime pattern="MM/dd/yyyy - hh:mm a"/>
		</h:outputText>
	</div>
	
	<h:form id="serviceForm" style="height:100%; padding:0px;" styleClass="w3-container">
		<p:dataTable id="services" var="service" value="#{checkoutBean.services}">
			<p:column style="width:100px;text-align: center;padding:0px;">
				<f:facet name="header">
					<p:commandButton onclick="PF('newServiceDialogVar').show();$('#serviceForm\\:addServicePanel input').val('');" value="Add Service" id="btnAddService"/>
				</f:facet>
	             <p:commandButton update=":serviceForm:editServiceDialogID" oncomplete="PF('editServiceDialogVar').show()" icon="ui-icon-pencil" title="Edit">
	                <f:setPropertyActionListener value="#{service}" target="#{checkoutBean.editTransactionService}" />
	            </p:commandButton>
	            <p:commandButton update=":serviceForm:services,transactionForm" actionListener="#{checkoutBean.deleteServiceRow(service)}" icon="ui-icon-closethick" title="Delete">
	            </p:commandButton>
	        </p:column>
			<p:column headerText="Service">
				<h:outputText value="#{service.serviceName}" />
			</p:column>
			<p:column headerText="Employee">
				<h:outputText value="#{service.employeeName}" />
			</p:column>
			<p:column headerText="Amount">
				<h:outputText value="#{service.amount}" >
					<f:convertNumber currencySymbol="$" type="currency"/>
				</h:outputText>
			</p:column>
			<p:column headerText="Discount">
				<h:outputText value="#{service.discount}" >
					<f:convertNumber currencySymbol="$" type="currency"/>
				</h:outputText>
			</p:column>
			<p:columnGroup type="footer">
				<p:row>
					<p:column>
						<f:facet name="footer">
							<p:outputLabel value="Discount: " />
						</f:facet>
					</p:column>
					<p:column>
						<f:facet name="footer">
							<p:inputText placeholder="Enter Discount" value="#{checkoutBean.newTransactionService.serviceName}" style="width:150px;"></p:inputText>
						</f:facet>
					</p:column>
					<p:column style="text-align:right" footerText="Totals:" />
					<p:column colspan="2" id="serviceTotal" styleClass="serviceTotal" style="text-align:left"
						footerText="#{checkoutBean.totalServiceAmount}" ></p:column>
				</p:row>
			</p:columnGroup>
		</p:dataTable>

		<p:dialog id="newServiceDialogID" position="center" widgetVar="newServiceDialogVar" header="Add New Service"
			modal="true" showEffect="fade" hideEffect="fade" resizable="false" >
			<h:panelGrid columns="2" cellpadding="0" id="addServicePanel">
				<p:outputLabel value="Service:" for="txtNewService" />
				<p:inputText id="txtNewService" placeholder="Enter Service" value="#{checkoutBean.newTransactionService.serviceName}"></p:inputText>
				
				<p:outputLabel value="Employye:" for="txtNewEmployee" />
				<p:inputText id="txtNewEmployee" placeholder="Enter Employee" value="#{checkoutBean.newTransactionService.employeeName}"></p:inputText>
				
				<p:outputLabel value="Amount:" for="txtNewAmount" />
				<p:inputText id="txtNewAmount" placeholder="Enter Amount" type="number"  value="#{checkoutBean.newTransactionService.amount}"></p:inputText>
				
				<p:outputLabel value="Discount:" for="txtNewDiscount" />
				<p:inputText id="txtNewDiscount" placeholder="Enter Amount" type="number"  value="#{checkoutBean.newTransactionService.discount}"></p:inputText>
				
				<p:outputLabel value="Discount %:" for="txtNewDiscountPercent" />
				<p:selectOneMenu id="txtNewDiscountPercent" value="#{checkoutBean.discountSelected}">
	                <f:selectItem itemLabel="Select Discount" itemValue="" noSelectionOption="true" />
	                <f:selectItems value="#{checkoutBean.discountTypes}" />
	            </p:selectOneMenu>
				
				<p:commandButton update=":serviceForm:services,transactionForm"  onclick="PF('newServiceDialogVar').hide();" actionListener="${checkoutBean.addServiceRow()}" value="Add" icon="ui-icon-circle-plus" />
				<p:commandButton onclick="PF('newServiceDialogVar').hide();" value="Cancel" icon="ui-icon-circle-plus" />
			</h:panelGrid>
		</p:dialog>
		
		<p:dialog id="editServiceDialogID" position="center" widgetVar="editServiceDialogVar" header="Edit Service"
			modal="true" showEffect="fade" hideEffect="fade" resizable="false">
			<h:panelGrid columns="2" cellpadding="0" id="editServicePanel">
				<p:outputLabel value="Service:" for="txtEditService" />
				<p:inputText id="txtEditService" placeholder="Enter Service" value="#{checkoutBean.editTransactionService.serviceName}" onfocus="$(this).select();"></p:inputText>
				
				<p:outputLabel value="Employee:" for="txtEditEmployee" />
				<p:inputText id="txtEditEmployee" placeholder="Enter Employee" value="#{checkoutBean.editTransactionService.employeeName}" onfocus="$(this).select();"></p:inputText>
				
				<p:outputLabel value="Amount:" for="txtEditAmount" />
				<p:inputText id="txtEditAmount" placeholder="Enter Amount" type="number"  value="#{checkoutBean.editTransactionService.amount}" onfocus="$(this).select();"></p:inputText>
				
				<p:outputLabel value="Discount:" for="txtEditDiscount" />
				<p:inputText id="txtEditDiscount" placeholder="Enter Amount" type="number"  value="#{checkoutBean.editTransactionService.discount}"></p:inputText>
				
				<p:outputLabel value="Discount %:" for="txtEditDiscountPercent" />
				<p:selectOneMenu id="txtEditDiscountPercent" value="#{checkoutBean.discountSelected}">
	                <f:selectItem itemLabel="Select Discount" itemValue="" noSelectionOption="true" />
	                <f:selectItems value="#{checkoutBean.discountTypes}" />
	            </p:selectOneMenu>
	            
				<p:commandButton update=":serviceForm:services,transactionForm" actionListener="#{checkoutBean.updateServicesAmount()}" onclick="PF('editServiceDialogVar').hide();" value="Save" icon="ui-icon-circle-plus" />
				<p:commandButton onclick="PF('editServiceDialogVar').hide();" value="Cancel" icon="ui-icon-circle-plus" />
			</h:panelGrid>
		</p:dialog>
	</h:form>
	
	<h:form id="transactionForm" styleClass="w3-container" style="padding:0px;">
		<div class="w3-container w3-half w3-xlarge">
			
		</div>
		<div class="w3-container w3-half">
			<div class="w3-quarter w3-xlarge">
				<h:panelGrid columns="1" cellpadding="0">
					<h:outputLabel value="&nbsp;"></h:outputLabel>
					<h:outputLabel value="&nbsp; "></h:outputLabel>
					<h:outputLabel value="&nbsp;"></h:outputLabel>
				</h:panelGrid>
			</div>
			<div class="w3-threequarter">
				<h:panelGrid columns="2" cellpadding="0">
					<h:outputLabel value="Tip: " for="tip"></h:outputLabel>
					<p:inputText id="tip" type="number" value="#{checkoutBean.tip}" onfocus="$(this).select()"></p:inputText>
					<h:outputLabel value="" for="tipAmount"></h:outputLabel>
					<p:selectOneRadio id="tipAmount" value="#{checkoutBean.tipSelected}" onchange="tipChange()" style="margin-left:-60px; width:300px; padding:0px; font-size:75%;padding:0px;">
						<f:selectItems value="#{checkoutBean.tipTypes}" var="c" itemLabel="#{tipType}" itemValue="#{tipType}" />
			        </p:selectOneRadio>
			        
					<h:outputLabel value="" styleClass="w3-xlarge">Total: </h:outputLabel>
					<p:outputLabel value="#{checkoutBean.total}" styleClass="w3-xlarge">
						<f:convertNumber pattern="$#0.00" />
					</p:outputLabel>
					
					<h:outputLabel value="" styleClass="w3-large">Pay by: </h:outputLabel>
					<h:outputLabel value="&nbsp;"></h:outputLabel>
			
					<h:outputLabel value="Credit: " for="credit"></h:outputLabel>
					<p:inputText id="credit" type="number" value="#{checkoutBean.credit}" onfocus="$(this).select()"></p:inputText>
					<h:outputLabel value="Cash:&nbsp;&nbsp;&nbsp;" for="cash"></h:outputLabel>
					<p:inputText id="cash" type="number" value="#{checkoutBean.cash}" onfocus="$(this).select()"></p:inputText>
					
					<h:outputLabel value="Gift:" for="gift"></h:outputLabel>
					<p:inputText id="gift" style="width:110px;" type="number" value="#{checkoutBean.giftCard}" onfocus="$(this).select()"></p:inputText>
					<h:outputLabel value="Gift#:" for="giftNo"></h:outputLabel>
					<p:inputText id="giftNo" style="width:160px;" value="#{checkoutBean.giftCardNo}" onfocus="$(this).select()"></p:inputText>
					
					
			     </h:panelGrid>
			</div>
		</div>
		<p:remoteCommand name="myRemote" actionListener="#{checkoutBean.tipChange()}" />
	</h:form>
	
	<div class="w3-center w3-container">
		<p:commandButton style="width:180px;height:50px;" value="Print"></p:commandButton>
			<p:commandButton style="width:180px;height:50px;" value="Email"></p:commandButton>
	</div>

	<h:outputScript library="js" name="common.js"></h:outputScript>
	<script>
		function tipChange() {
			myRemote();
		}
	</script>
</h:body>
</html>