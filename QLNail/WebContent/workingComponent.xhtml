<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<meta http-equiv="x-ua-compatible" content="ie=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<h:outputStylesheet library="css" name="common.css" />
	<h:outputStylesheet library="css" name="w3.css"></h:outputStylesheet>

	<h:outputScript library="js" name="jquery.formatCurrency-1.4.0.min.js"></h:outputScript>

	<style>
.ui-datatable .ui-datatable-header, .ui-datatable .ui-datatable-footer {
	text-align: left;
}
</style>

	<title>Insert title here</title>
</h:head>
<h:body>
	<!-- Date/Time -->
	<div class="w3-container w3-xlarge">
		<label class="w3-label">Date/Time: </label>
		<h:outputText value="#{checkoutBean.currDateTime}">
			<f:convertDateTime pattern="MM/dd/yyyy - hh:mm a" />
		</h:outputText>
	</div>
	<!-- Date/Time END -->
	
	<!-- MainForm -->
	<h:form id="serviceForm" >
		<!-- Services -->
		<p:dataTable id="services" var="service"
			value="#{checkoutBean.services}" editable="true" editMode="cell"
			widgetVar="cellServices">

			<p:ajax event="cellEdit" oncomplete="updateServicesAmount()" />
			<p:column headerText="Id" style="display:none">
				<p:cellEditor>
					<f:facet name="output">
						<h:outputText value="#{service.transactionServiceID}" />
					</f:facet>
					<f:facet name="input">
						<p:inputText id="modelInput"
							value="#{service.transactionServiceID}" style="width:96%" />
					</f:facet>
				</p:cellEditor>
			</p:column>

			<p:column style="width:60px">
				<p:commandButton update="serviceForm"
					actionListener="#{checkoutBean.deleteServiceRow(service)}"
					oncomplete="updateServicesAmount()" icon="fa fa-times"></p:commandButton>
			</p:column>

			<p:column>
				<f:facet name="header">
					<p:commandButton update="@form"
						actionListener="#{checkoutBean.addServiceRow()}"
						oncomplete="updateServicesAmount()" value="Add"
						styleClass="w3-left"></p:commandButton>
					<h:outputText value="Service" styleClass="w3-center" />
				</f:facet>
				<p:cellEditor>
					<f:facet name="output">
						<h:outputText value="#{service.serviceName}" />
					</f:facet>
					<f:facet name="input">
						<p:inputText value="#{service.serviceName}" style="width:96%"
							label="Service" />
					</f:facet>
				</p:cellEditor>
			</p:column>

			<p:column headerText="Staff">
				<p:cellEditor>
					<f:facet name="output">
						<h:outputText value="#{service.employeeName}" />
					</f:facet>
					<f:facet name="input">
						<p:inputText value="#{service.employeeName}" style="width:96%"
							label="Staff" />
					</f:facet>
				</p:cellEditor>
			</p:column>

			<p:column headerText="Amount" style="width:200px">
				<p:cellEditor>
					<f:facet name="output">
						<h:outputText styleClass="serviceAmount" value="#{service.amount}">
							<f:convertNumber type="currency"></f:convertNumber>
						</h:outputText>
					</f:facet>
					<f:facet name="input">
						<p:inputText value="#{service.amount}" style="width:96%" type="number"
							label="Amount" />
							
					</f:facet>
				</p:cellEditor>
			</p:column>
			<p:columnGroup type="footer">
				<p:row>
					<p:column colspan="3" style="text-align:right" footerText="Totals:" />
					<p:column id="serviceTotal" styleClass="serviceTotal"
						style="text-align:left"></p:column>
				</p:row>

			</p:columnGroup>

		</p:dataTable>
		<!-- Services End -->
		
		<!-- Discount -->
		<p:panelGrid>
			<f:facet name="footer">
				<p:row>
					<p:column style="text-align:left">
						<h:outputText value="Staff Discount: " />
						<p:selectBooleanButton id="dcStaff" value="#{checkoutBean.staffDiscount}" onLabel="Yes"
							offLabel="No" onIcon="ui-icon-check" offIcon="ui-icon-close" />
						<h:outputText styleClass="w3-right" value="Discount :"></h:outputText>
					</p:column>
					<p:column style="text-align:left; width:200px">
						<p:selectBooleanButton styleClass="dcAmount" rendered="#{checkoutBean.dcAmountShow}" value="#{checkoutBean.dcAmountBtnStatus}" onLabel="$"
							offLabel="$" >
							<p:ajax update="@form" listener="#{checkoutBean.changeDCShow}" />
						</p:selectBooleanButton>
						<p:inputText styleClass="dcInpAmount" onfocus="this.select()" value="#{checkoutBean.dcAmount}" rendered="#{checkoutBean.dcAmountBtnStatus}" type="number" onchange="updateTotal()"
							style="width:100px"></p:inputText>
						<p:selectBooleanButton styleClass="dcPercent"  rendered="#{checkoutBean.dcPercentShow}" value="#{checkoutBean.dcPercentBtnStatus}" onLabel="%"
							offLabel="%" >
							<p:ajax update="@form" listener="#{checkoutBean.changeDCShow}" />
						</p:selectBooleanButton>
						<p:inputText styleClass="dcInpPercent" valueChangeListener="#{checkoutBean.changeDCShow}" value="#{checkoutBean.dcPercent}" rendered="#{checkoutBean.dcPercentBtnStatus}" type="number" onchange="updateTotal()"
							style="width:100px"></p:inputText>
					</p:column>
				</p:row>
			</f:facet>
		</p:panelGrid>
		<!-- Discount End -->
		
		<!-- Transaction -->
		<div class="w3-container w3-half w3-xlarge"></div>
		<div class="w3-container w3-half">
			<p:panelGrid style="margin-top:10px; margin-bottom:10px">
				<p:row>
					<p:column style="width:100px">Tip:</p:column>
					<p:column>
						<p:inputText styleClass="tip" type="number" value="#{checkoutBean.tip}" onchange="updateTotal()"></p:inputText>
					</p:column>
				</p:row>
				<p:row>
					<p:column>Total:</p:column>
					<p:column>
						<h:outputText styleClass="total" value="$0.00"></h:outputText>
					</p:column>
				</p:row>
				<p:row>
					<p:column>Pay by:</p:column>
					<p:column styleClass="payType">
						<div>
							<div class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only">
								<label class="ui-button-text ui-c">C
									<input id="test" type="checkbox"  onchange="$(this).parent().toggleClass('ui-state-active')" style="display:none" />
								</label>
							</div>
							<input name="credit" value="200"></input>
							<p:selectBooleanButton styleClass="cash" onchange="selectCash()"
								value="false" onLabel="Cash" offLabel="Cash" />
							<p:inputText styleClass="cashInp" type="number"
								style="width:100px; display:none"></p:inputText>
							<p:selectBooleanButton styleClass="credit"
								onchange="selectCredit()" value="false" onLabel="Credit"
								offLabel="Credit" />
							<p:inputText styleClass="creditInp" type="number"
								style="width:100px; display:none"></p:inputText>
							<p:selectBooleanButton styleClass="gift" onchange="selectGift()"
								value="false" onLabel="Gift" offLabel="Gift" />
							<p:inputText styleClass="giftInpNo" placeholder="Gift#"
								style="width:200px; display:none"></p:inputText>
							<p:inputText styleClass="giftInpAmount" type="number" placeholder="Gift$"
								style="width:100px; display:none"></p:inputText>
								
								<p:commandButton styleClass="w3-right" value="Add Pay Type" onclick="addPayType()"></p:commandButton>
						</div>
						
					</p:column>
				</p:row>
			</p:panelGrid>
		</div>
		<!-- Transaction END -->
		
		<!-- Action -->
		<div class="w3-center w3-container">
			
			<p:commandButton style="width:180px;height:50px;" value="Print" actionListener="#{checkoutBean.print}"></p:commandButton>
			<p:commandButton style="width:180px;height:50px;" value="Email"></p:commandButton>
		</div>
		<!-- Action END-->
		
	</h:form>
	<!-- MainForm END -->
	
	
	<h:outputScript library="js" name="common.js"></h:outputScript>
	<script>
		$(function() {
			updateServicesAmount();
		});

		function updateServicesAmount() {
			var total = 0;
			$('.serviceAmount').each(function(index) {
				total += parseFloat($(this).text().replace(/\\$|,/g, ''));
			});
			$('.serviceTotal').text(total);
			$('.serviceTotal').formatCurrency();

			updateTotal();
		}

		function updateTotal() {
			// services
			//var serviceAmount = parseFloat($('.serviceTotal').text().replace(
			//		/\\$|,/g, ''));
			// Discount
			//var dcAmount;
			//if ($('.dcPercent').hasClass('ui-state-active')) {
			//	dcAmount = +$('.dcInpPercent').val() * serviceAmount / 100;
			//} else {
			//	dcAmount = +$('.dcInpAmount').val();
			//}
			// tip
			//var tip = +$('.tip').val();
			//
			//$('.total').text( serviceAmount + dcAmount + tip);
			//$('.total').formatCurrency();
		}

		function selectDCAmount() {
			if ($('.dcAmount').hasClass('ui-state-active')) {
				$('.dcPercent').removeClass('ui-state-active');
				$('.dcPercent input').prop("checked", false);
				$('.dcPercent').hide();
				$('.dcInpAmount').show();

				$('.dcInpAmount').focus();
			} else {
				$('.dcPercent').show();
				$('.dcInpAmount').hide();
			}
		}
		function selectDCPercent() {
			if ($('.dcPercent').hasClass('ui-state-active')) {
				$('.dcAmount').removeClass('ui-state-active');
				$('.dcAmount input').prop("checked", false);
				$('.dcAmount').hide();
				$('.dcInpPercent').show();
			} else {
				$('.dcAmount').show();
				$('.dcInpPercent').hide();
			}
		}
		
		function addPayType() {
		}
		function selectCash( row) {
			if ($('.cash').hasClass('ui-state-active')) {
				$('.credit, .gift').removeClass('ui-state-active');
				$('.credit input, .gift input').prop("checked", false);
				$('.credit, .gift').hide();
				$('.cashInp').show();

			} else {
				$('.credit, .gift').show();
				$('.cashInp').hide();
			}
		}
	</script>
</h:body>
</html>